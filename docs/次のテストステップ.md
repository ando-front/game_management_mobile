# 次のテストステップ

**前回の成果**: ✅ テスト1（PIN入力フロー）成功！

---

## 🎉 完了したテスト

### ✅ テスト1: 基本的なPIN入力フロー
- PIN入力画面の表示
- 「開く」ボタンの動作
- 親管理画面への遷移
- **Bug #001 & #002の修正確認完了**

---

## 🎯 推奨: 次の3つのテストを実施（10分）

### テスト2: 時間付与（2分）

**手順**:
1. 親管理画面で「+5分」ボタンをクリック
2. トースト通知を確認
3. 「子供モードへ →」ボタンをクリック
4. 子供用ホーム画面に戻る

**期待結果**:
- ✅ トースト「+5分 付与しました」が表示される
- ✅ 残り時間が「5 分」になる
- ✅ 「ゲームをはじめる」ボタンが有効（青色）になる

**確認ポイント**:
- トースト通知が3秒後に自動で消える
- 残り時間の表示が正しい

---

### テスト3: ゲーム実行（3分）

**手順**:
1. 子供用ホーム画面で「ゲームをはじめる」ボタンをクリック
2. 画面が「ゲーム中」に変わることを確認
3. 30秒待機（経過時間が更新されることを確認）
4. 「長押しで終了する」ボタンを**1秒程度長押し**
5. 確認ダイアログが表示されたら「終了する」をクリック

**期待結果**:
- ✅ 「ゲーム中」画面に遷移
- ✅ 経過時間が「00:01」「00:02」...と1秒ごとに更新
- ✅ 長押しで確認ダイアログが表示される
- ✅ 終了後、残り時間が減少（約4分になる）
- ✅ 子供用ホーム画面に戻る

**確認ポイント**:
- 短いタップでは終了しない（誤操作防止）
- 経過時間が正確にカウントされる
- 消費時間が切り上げで計算される（30秒 = 1分消費）

---

### テスト4: データ永続化（2分）

**手順**:
1. 現在の残り時間を確認（約4分のはず）
2. ブラウザのタブを閉じる
3. 再度 http://localhost:5173 を開く

**期待結果**:
- ✅ 残り時間が保持されている（約4分）
- ✅ アプリの状態が復元される

**追加確認**:
1. F12キーを押して開発者ツールを開く
2. 「Application」タブをクリック
3. 左サイドバー: Storage → IndexedDB → GameTimeDB を展開

**期待結果**:
- ✅ `appState` テーブルが存在
- ✅ `usageLogs` テーブルが存在
- ✅ `appState`に1件のデータがある
- ✅ `usageLogs`に2件のデータがある（1件: 付与、1件: 消費）

---

## 📋 その後のテスト（オプション）

時間がある場合は、以下も実施してください：

### テスト5: PIN誤入力（2分）

**手順**:
1. 「親モード →」をクリック
2. 誤ったPIN「1234」を入力
3. 「開く」をクリック

**期待結果**:
- ✅ エラーメッセージ「PINが正しくありません（1/5回）」
- ✅ PIN入力画面のまま

**追加テスト**:
- さらに4回誤入力（合計5回）
- **期待**: 「5回失敗しました。30秒後に再試行してください」
- 30秒待機
- 正しいPIN「0000」で入室できることを確認

---

### テスト6: PIN変更（3分）

**手順**:
1. 親管理画面で「PIN変更」ボタンをクリック
2. ダイアログが表示される
3. 以下を入力:
   - 現在のPIN: `0000`
   - 新しいPIN: `1234`
   - 確認PIN: `1234`
4. 「変更する」ボタンをクリック

**期待結果**:
- ✅ トースト「PINを変更しました」が表示
- ✅ ダイアログが閉じる

**確認**:
1. 「子供モードへ →」で戻る
2. 「親モード →」で再度入室
3. 旧PIN「0000」を入力 → エラー
4. 新PIN「1234」を入力 → 成功

**重要**: テスト後は元に戻してください
- PIN変更で「1234」→「0000」に戻す

---

### テスト7: 利用履歴の確認（1分）

**手順**:
1. 親管理画面の「利用履歴」セクションを見る

**期待結果**:
- ✅ 最新10件の履歴が表示される
- ✅ 付与の履歴が緑色で「+5分」
- ✅ 消費の履歴が赤色で「-1分」
- ✅ 日時が正しく表示される

---

### テスト8: データエクスポート（1分）

**手順**:
1. 親管理画面で「データをエクスポート」ボタンをクリック

**期待結果**:
- ✅ JSONファイルがダウンロードされる
- ✅ ファイル名が `game-time-backup_2025-10-05.json` 形式

**追加確認**:
1. ダウンロードしたファイルをテキストエディタで開く
2. JSONデータが正しく含まれていることを確認

---

## 🚀 テスト実施後のアクション

### すべてのテストが成功した場合

1. **ドキュメント更新**:
   - [docs/テスト実施レポート.md](テスト実施レポート.md) の各テスト項目を「✅ 成功」に更新

2. **次のフェーズ**:
   - アイコンPNG生成: [../public/ICON_README.md](../public/ICON_README.md)
   - 本番ビルド: `npm run build`
   - デプロイ準備

### バグが見つかった場合

1. **バグ報告**:
   - [docs/バグ修正履歴.md](バグ修正履歴.md) にBug #003として記録
   - 以下の情報を含める:
     - 再現手順
     - 期待される動作
     - 実際の動作
     - ブラウザコンソールのエラー（F12 → Console）

2. **報告テンプレート**:
   ```
   Bug #003: [バグのタイトル]
   
   再現手順:
   1. ...
   2. ...
   
   期待: ...
   実際: ...
   
   コンソールエラー: ...
   ```

---

## 💡 テストのヒント

### 1. コンソールを開いておく
- F12キーで開発者ツールを開く
- Consoleタブでエラーがないか確認
- エラーが出た場合はすぐに報告

### 2. 各テストは独立している
- テスト順序を変えても問題なし
- 途中でリロードしても大丈夫（データは保存されている）

### 3. 問題が起きたら
- ブラウザをリロード（Ctrl+R / Cmd+R）
- それでも直らない場合はIndexedDBをクリア:
  - F12 → Application → Storage → Clear site data

---

## ⏱️ 推奨スケジュール

### クイックテスト（10分）- 最優先
- ✅ テスト1: PIN入力フロー（完了）
- テスト2: 時間付与（2分）
- テスト3: ゲーム実行（3分）
- テスト4: データ永続化（2分）

### フルテスト（20分）- 時間がある場合
- クイックテスト（10分）
- テスト5: PIN誤入力（2分）
- テスト6: PIN変更（3分）
- テスト7: 利用履歴（1分）
- テスト8: データエクスポート（1分）

---

**次はテスト2〜4のクイックテストをお願いします！** 🚀

成功したら報告してください。バグが見つかった場合も遠慮なくお知らせください。
