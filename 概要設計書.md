

## 🏗️ 概要設計書（High-Level Design）

### 1. システム構成図（概要）

```mermaid
flowchart TD
  subgraph 親デバイス
    P1[親アプリUI]
    P2[Firebase Auth]
    P3[タスク管理画面]
    P4[時間操作画面]
  end

  subgraph 子供デバイス
    C1[子供アプリUI]
    C2[残り時間表示]
    C3[ゲーム時間スタート/ストップ]
    C4[完了タスク送信]
  end

  subgraph Firebase（バックエンド）
    DB[Firestore DB]
    AUTH[認証]
    FUNC[Cloud Functions]
  end

  P1 --> P2 --> AUTH
  C1 --> P2
  P1 --> P3 --> DB
  P1 --> P4 --> DB
  C1 --> C2 --> DB
  C1 --> C3 --> DB
  C1 --> C4 --> DB
  DB <--> FUNC
```

---

### 2. データ構造（Firestore）

#### users（親・子供共通）

```json
{
  "uid": "xxxxx",
  "role": "parent | child",
  "name": "たろう",
  "gameMinutes": 45
}
```

#### tasks

```json
{
  "taskId": "abc123",
  "userId": "xxxxx",
  "title": "宿題（算数）",
  "expectedMinutes": 30,
  "rewardMinutes": 10,
  "status": "pending | done | approved"
}
```

#### usage_logs

```json
{
  "userId": "xxxxx",
  "start": "2025-10-05T17:00:00Z",
  "end": "2025-10-05T17:20:00Z",
  "duration": 20
}
```

---

### 3. UIイメージ（概要）

#### 子供用

* ホーム画面：残り時間の大きな表示
* ボタン：「ゲームを始める」「終了する」
* タスク画面：完了ボタン付きリスト

#### 親用

* タスク登録画面：タスク名／時間／報酬
* 子供ごとのゲーム時間リスト
* 時間追加・リセット機能

---

### 4. 音声連携（将来構想）

* Alexaスキル or Google Assistant連携

  * 子供「今日のゲーム時間は？」→ アプリのDBを音声で返答
  * 親「時間追加して」→ Firebase Cloud Function 経由でDB更新

---

必要に応じて以下の資料も追加でご用意できます：

* 詳細設計書（画面遷移図、コンポーネント設計など）
* テスト仕様書
* Firebase初期構成セットアップ手順
* デプロイCI/CD構成（FlutterFlowやGitHub Actionsなど）

ご希望があれば続きます。どこから着手しましょうか？
